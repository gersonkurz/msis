<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs" xmlns:util="http://wixtoolset.org/schemas/v4/wxs/util">
    <Package Name="{{PRODUCT_NAME}}" UpgradeCode="{{UPGRADE_CODE}}" Language="{{LCID}}" Codepage="{{CODEPAGE}}" Version="{{PRODUCT_VERSION}}" Manufacturer="{{MANUFACTURER}}" InstallerVersion="301">
        <SummaryInformation Keywords="Installer" Description="{{PRODUCT_NAME}}" Manufacturer="{{MANUFACTURER}}" Codepage="{{CODEPAGE}}" />
        <Media Id="1" Cabinet="setupthis.cab" EmbedCab="yes" />
        <SetProperty Id="COMPUTERNAME" Before="InstallInitialize" Sequence="execute" Value="[%COMPUTERNAME]" />
        <MajorUpgrade AllowSameVersionUpgrades="yes" DowngradeErrorMessage="A later version of [ProductName] is already installed. Setup will now exit." />
        <util:QueryWindowsWellKnownSIDs />
		<Binary Id="binary.dll" SourceFile="{{TEMPLATE_FOLDER}}/x86/{{DLL_ENTRY}}" />
        {{#if SETUP_ICON }}
        <Icon Id="ngbt_setup_icon.ico" SourceFile="{{SETUP_ICON}}" />
        <Property Id="ARPPRODUCTICON" Value="ngbt_setup_icon.ico" />
        {{/if}}
        {{#if DLL_CUSTOM }}
        <Binary Id="CustomAction" SourceFile="{{DLL_CUSTOM}}" />
        {{/if}}
        {{#unless REPAIR_ENABLED }}
        <Property Id="ARPNOREPAIR" Value="yes" Secure="yes" />
        {{/unless}}
        {{#unless REMOVE_ENABLED }}
        <Property Id="ARPNOMODIFY" Value="yes" Secure="yes" />
        {{/unless}}
        {{#if REMOVE_REGISTRY_TREE }}
        <Property Id="REMOVE_REGISTRY_TREE" Value="{{ REMOVE_REGISTRY_TREE }}" Secure="yes" />
        {{/if}}
        <DirectoryRef Id="INSTALLDIR">
			<Merge Id="VCRedist_141" SourceFile="{{TEMPLATE_FOLDER}}\mergemodules\Microsoft_VC141_CRT_x86.msm" DiskId="1" Language="0" />
            <Merge Id="VCRedist_140" SourceFile="{{TEMPLATE_FOLDER}}\mergemodules\Microsoft_VC140_CRT_x86.msm" DiskId="1" Language="0" />
            <Merge Id="VCRedist_100" SourceFile="{{TEMPLATE_FOLDER}}\mergemodules\Microsoft_VC100_CRT_x86.msm" DiskId="1" Language="0" />
        </DirectoryRef>
        <Feature Id="VCRedist" Title="Visual C++ Runtime" AllowAdvertise="no" Display="hidden" Level="1">
			<MergeRef Id="VCRedist_141" />
            <MergeRef Id="VCRedist_140" />
            <MergeRef Id="VCRedist_100" />
        </Feature>
        {{{FEATURES}}}
        {{#if REMOVE_FOLDERS_ON_UNINSTALL }}
        <CustomAction Id="RemoveAllFoldersOnUninstall" Return="check" Execute="immediate" DllEntry="RemoveAllFoldersOnUninstall" BinaryRef="binary.dll" />
        {{/if}}
        {{#if REMOVE_REGISTRY_TREE }}
        <CustomAction Id="RemoveRegistryTreeOnUninstall" Return="check" Execute="deferred" Impersonate="no" DllEntry="RemoveRegistryTreeOnUninstall" BinaryRef="binary.dll" />
        {{/if}}

        {{#if DLL_CUSTOM }}
        <CustomAction Id="BeforeInstallAction" DllEntry="BeforeInstall" Return="check" BinaryRef="CustomAction" />
        <CustomAction Id="AfterInstallAction" DllEntry="AfterInstall" Return="check" BinaryRef="CustomAction" />
        <CustomAction Id="BeforeUninstallAction" DllEntry="BeforeUninstall" Return="check" BinaryRef="CustomAction" />
        <CustomAction Id="AfterUninstallAction" DllEntry="AfterUninstall" Return="check" BinaryRef="CustomAction" />
        {{/if}}

        {{{CUSTOM_ACTIONS}}}
        <CustomAction Id="BeforeInstall" Return="ignore" Execute="commit" Impersonate="no" DllEntry="BeforeInstall" BinaryRef="binary.dll" />
        <CustomAction Id="AfterInstall" Return="ignore" Execute="commit" Impersonate="no" DllEntry="AfterInstall" BinaryRef="binary.dll" />
        <CustomAction Id="BeforeUpgrade" Return="ignore" Execute="commit" Impersonate="no" DllEntry="BeforeUpgrade" BinaryRef="binary.dll" />
        <CustomAction Id="AfterUpgrade" Return="ignore" Execute="commit" Impersonate="no" DllEntry="AfterUpgrade" BinaryRef="binary.dll" />
        <CustomAction Id="BeforeUninstall" Return="ignore" Execute="commit" Impersonate="no" DllEntry="BeforeUninstall" BinaryRef="binary.dll" />
        <CustomAction Id="AfterUninstall" Return="ignore" Execute="commit" Impersonate="no" DllEntry="AfterUninstall" BinaryRef="binary.dll" />

		<InstallExecuteSequence>
            {{{INSTALL_EXECUTE_SEQUENCE}}}
            {{#if DLL_CUSTOM }}
            <Custom Action="BeforeInstallAction" After="CostFinalize" Condition="NOT Installed AND NOT PATCH" />
            <Custom Action="AfterInstallAction" After="InstallFinalize" Condition="NOT Installed" />
            <Custom Action="BeforeUninstallAction" After="CostFinalize" Condition="(REMOVE = &quot;ALL&quot;) AND NOT UPGRADINGPRODUCTCODE" />
            {{/if}}
            <Custom Action="BeforeInstall" After="InstallInitialize" Condition="NOT Installed" />
            <Custom Action="AfterInstall" Before="InstallFinalize" Condition="NOT Installed" />
            <Custom Action="BeforeUpgrade" After="InstallInitialize" Condition="UPGRADINGPRODUCTCODE" />
            <Custom Action="AfterUpgrade" Before="InstallFinalize" Condition="UPGRADINGPRODUCTCODE" />
            <Custom Action="BeforeUninstall" After="InstallInitialize" Condition="(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=&quot;ALL&quot;)" />
            {{#if REMOVE_FOLDERS_ON_UNINSTALL }}
            <Custom Action="RemoveAllFoldersOnUninstall" After="InstallFinalize" Condition="(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=&quot;ALL&quot;)" />
            {{/if}}
            {{#if REMOVE_REGISTRY_TREE }}
            <Custom Action="RemoveRegistryTreeOnUninstall" Before="InstallFinalize" Condition="(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=&quot;ALL&quot;)" />
            {{/if}}
            {{#if DLL_CUSTOM }}
            <Custom Action="AfterUninstallAction" After="RemoveAllFoldersOnUninstall" Condition="(REMOVE = &quot;ALL&quot;) AND NOT UPGRADINGPRODUCTCODE" />
            {{/if}}
            <Custom Action="AfterUninstall" Before="InstallFinalize" Condition="(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=&quot;ALL&quot;)" />
            {{#if SCHEDULE_REBOOT }}
            <ScheduleReboot After="InstallFinalize" Condition="(NOT UPGRADINGPRODUCTCODE) AND (REMOVE=&quot;ALL&quot;)" />
            {{/if}}
        </InstallExecuteSequence>

        <StandardDirectory Id="DesktopFolder">{{{DESKTOP_FILES}}}</StandardDirectory>
        <StandardDirectory Id="CommonAppDataFolder">{{{APPDATADIR_FILES}}}</StandardDirectory>
        <StandardDirectory Id="AppDataFolder">{{{ROAMINGAPPDATADIR_FILES}}}</StandardDirectory>
        <StandardDirectory Id="LocalAppDataFolder">{{{LOCALAPPDATADIR_FILES}}}</StandardDirectory>
        <StandardDirectory Id="CommonFilesFolder">{{{COMMONFILESDIR_FILES}}}</StandardDirectory>
        <StandardDirectory Id="WindowsFolder">{{{WINDOWSDIR_FILES}}}</StandardDirectory>
        <StandardDirectory Id="SystemFolder">{{{SYSTEMDIR_FILES}}}</StandardDirectory>
        <StandardDirectory Id="ProgramFilesFolder">
            {{{INSTALLDIR_FILES}}}
            <!-- Note: The next empty directory is needed so that the Default INSTALLFOLDER created by WixToolset IS NOT CREATED -->
            <!-- https://docs.firegiant.com/wix/fivefour/#default-installation-folder -->
			<Directory Id="INSTALLFOLDER" />
        </StandardDirectory>
        <StandardDirectory Id="ProgramMenuFolder">{{{STARTMENU_FILES}}}</StandardDirectory>
        {{{REGISTRY_ENTRIES}}}
    </Package>
</Wix>